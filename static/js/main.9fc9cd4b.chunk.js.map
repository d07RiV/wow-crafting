{"version":3,"sources":["nexushub.js","data.js","logic.js","App.js","index.js"],"names":["serverList","fetch","then","r","json","dataCache","loadData","server","faction","slug","Promise","all","alliance","horde","keys","Set","Object","fromEntries","map","key","a","h","quantity","marketValue","Math","min","data","itemId","assign","crafting","quests","item","process","results","Error","info","Data","id","quality","vendor","vendorPrice","category","reagents","requiredMoney","amountCrafted","craftMin","craftMax","craftingPrice","entries","reduce","total","name","bindOnPickup","price","Infinity","filter","x","isNaN","forEach","n","usePersistentState","initialValue","React","useState","window","localStorage","getItem","JSON","parse","error","console","value","setValue","useEffect","setItem","stringify","serverOptions","servers","regions","region","push","label","list","sort","name1","name2","localeCompare","options","factionOptions","profNames","alchemy","blacksmithing","cooking","enchanting","engineering","firstaid","leatherworking","tailoring","categoryNames","quest","tierset","itemOptions","term","callback","length","toLowerCase","categories","includes","cat","Money","isFinite","gold","floor","silver","copper","className","itemDefault","overrides","itemPrice","profLabel","shoppingList","count","mode","numCraft","ceil","money","ItemLink","href","target","rel","ResultView","setOverrides","setMarket","useCallback","ov","setCrafting","Fragment","onClick","ShoppingList","useMemo","res","n1","c1","n2","c2","App","setServerList","opt","setServer","setFaction","setResults","onServerChange","v","onFactionChange","onItemChange","toCalc","useRef","current","calculate","onChange","placeholder","loadOptions","noOptionsMessage","ReactDOM","render","document","getElementById"],"mappings":"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","file":"static/js/main.9fc9cd4b.chunk.js","sourcesContent":["export const serverList = fetch('https://api.nexushub.co/wow-classic/v1/servers/full/').then(r => r.json());\r\n\r\nconst dataCache = {};\r\n\r\nfunction merge(a, h) {\r\n  if (a && h) {\r\n    return {quantity: a.quantity + h.quantity, marketValue: Math.min(a.marketValue, h.marketValue), faction: a.marketValue < h.marketValue ? \"alliance\" : \"horde\"};\r\n  } else if (a) {\r\n    return {...a, faction: \"alliance\"};\r\n  } else if (h) {\r\n    return {...h, faction: \"horde\"};\r\n  }\r\n}\r\n\r\nexport function loadData(server, faction) {\r\n  const slug = `${server}-${faction}`;\r\n  if (dataCache[slug]) return dataCache[slug];\r\n  if (faction === \"both\") {\r\n    return dataCache[slug] = Promise.all([loadData(server, \"alliance\"), loadData(server, \"horde\")]).then(([alliance, horde]) => {\r\n      const keys = new Set([...Object.keys(alliance), ...Object.keys(horde)]);\r\n      return Object.fromEntries([...keys].map(key => [key, merge(alliance[key], horde[key])]));\r\n    });\r\n  } else {\r\n    return dataCache[slug] = fetch(`https://api.nexushub.co/wow-classic/v1/items/${slug}/`)\r\n      .then(r => r.json())\r\n      .then(r => Object.fromEntries(r.data.map(({itemId, quantity, marketValue}) => [itemId, {quantity, marketValue}])));\r\n  }\r\n}\r\n","import crafting from './crafting.json';\r\nimport quests from './quests.json';\r\n\r\nObject.assign(crafting, quests);\r\n\r\nexport default crafting;\r\n","import { loadData } from './nexushub';\r\nimport Data from './data';\r\n\r\nexport default async function calculate(server, faction, item) {\r\n  const data = await loadData(server, faction);\r\n\r\n  const price = r => Math.min(...[r.vendorPrice, r.marketValue, r.craftingPrice, r.bindOnPickup ? 0 : Infinity].filter(x => !isNaN(x)));\r\n\r\n  const results = {};\r\n  function process(item) {\r\n    if (results[item] === \"processing\") throw Error(`cyclical dependency for ${item}`);\r\n    if (!results[item]) {\r\n      const info = Data[item];\r\n      if (!info) {\r\n        throw Error(`item not found: ${item}`);\r\n      }\r\n      const r = results[item] = {};\r\n      r.id = info.id;\r\n      r.quality = info.quality;\r\n      if (info.id && data[info.id]) {\r\n        Object.assign(r, data[info.id]);\r\n      }\r\n      if (info.vendor) {\r\n        r.vendorPrice = info.vendor;\r\n      }\r\n      r.category = info.category;\r\n      if (info.reagents) {\r\n        r.crafting = info.reagents;\r\n        r.requiredMoney = info.requiredMoney || 0;\r\n        r.amountCrafted = ((info.craftMin || 1) + (info.craftMax || 1)) / 2;\r\n        r.craftMin = info.craftMin || 1;\r\n        r.craftingPrice = Object.entries(r.crafting).reduce((total, [name, quantity]) => total + process(name) * quantity, r.requiredMoney) / r.amountCrafted;\r\n      } else if (info.bindOnPickup) {\r\n        r.bindOnPickup = true;\r\n      }\r\n    }\r\n    return price(results[item]);\r\n  }\r\n  //process(item);\r\n  Object.keys(Data).forEach(n => process(n));\r\n  return results;\r\n}\r\n","import React from 'react';\nimport './App.scss';\n\nimport Select from 'react-select';\nimport AsyncSelect from 'react-select/async';\n\nimport { serverList } from './nexushub';\n\nimport Data from './data';\nimport calculate from './logic';\n\nfunction usePersistentState(key, initialValue) {\n  const [value, setValue] = React.useState(() => {\n    try {\n      const item = window.localStorage.getItem(key);\n      return item != null ? JSON.parse(item) : initialValue;\n    } catch (error) {\n      console.error(error);\n      return initialValue;\n    }\n  });\n  React.useEffect(() => {\n    try {\n      window.localStorage.setItem(key, JSON.stringify(value));\n    } catch (error) {\n      console.error(error);\n    }\n  }, [key, value]);\n  return [value, setValue];\n}\n\nconst serverOptions = serverList.then(servers => {\n  const regions = {};\n  servers.forEach(({slug, name, region}) => {\n    if (!regions[region]) regions[region] = [];\n    regions[region].push({value: slug, label: name});\n  });\n  return Object.entries(regions).map(([region, list]) => {\n    list.sort(({label: name1}, {label: name2}) => name1.localeCompare(name2));\n    return {label: region, options: list};\n  });\n});\n\nconst factionOptions = [\n  {value: \"alliance\", label: \"Alliance\"},\n  {value: \"horde\", label: \"Horde\"},\n  {value: \"both\", label: \"Both\"},\n];\n\nconst profNames = {alchemy: \"Alchemy\", blacksmithing: \"Blacksmithing\", cooking: \"Cooking\", enchanting: \"Enchanting\", engineering: \"Engineering\", firstaid: \"First Aid\", leatherworking: \"Leatherworking\", tailoring: \"Tailoring\"};\nconst categoryNames = {...profNames, quest: \"Quests\", tierset: \"Tier Sets\", \"\": \"Misc\"};\n\nconst itemOptions = (term, callback) => {\n  if (term.length < 3) callback([]);\n  term = term.toLowerCase();\n  const categories = {};\n  Object.entries(Data).filter(([name, data]) => data.reagents && name.toLowerCase().includes(term)).forEach(([name, data]) => {\n    categories[data.category || \"\"] = (categories[data.category || \"\"] || []);\n    categories[data.category || \"\"].push({value: name, label: name});\n  });\n  callback(Object.entries(categories).map(([cat, list]) => ({label: categoryNames[cat], options: list})));\n}\n\nfunction Money({value}) {\n  if (!isFinite(value)) {\n    return \"Not available\";\n  }\n  if (!value) {\n    return \"0\";\n  }\n  const gold = Math.floor(value / 10000);\n  const silver = Math.floor(value / 100) % 100;\n  const copper = Math.floor(value) % 100;\n  return (\n    <span>\n      {gold !== 0 && <span className=\"money-gold\">{gold}</span>}{gold !== 0 && (silver + copper) !== 0 && \" \"}\n      {silver !== 0 && <span className=\"money-silver\">{silver}</span>}{silver !== 0 && copper !== 0 && \" \"}\n      {copper !== 0 && <span className=\"money-copper\">{copper}</span>}\n    </span>\n  );\n}\n\nfunction itemDefault(results, item) {\n  const data = results[item];\n  if (!data) {\n    debugger;\n  }\n  if (!isNaN(data.craftingPrice) && (!data.marketValue || data.craftingPrice < data.marketValue)) {\n    return \"crafting\";\n  } else {\n    return \"market\";\n  }\n}\n\nfunction itemPrice(results, item, overrides) {\n  const data = results[item];\n  if (data.vendorPrice) {\n    return data.vendorPrice;\n  }\n  const mode = overrides[item] || itemDefault(results, item);\n  if (mode === \"crafting\" && data.crafting) {\n    return craftingPrice(results, item, overrides) / data.amountCrafted;\n  } else if (data.bindOnPickup) {\n    return 0;\n  } else {\n    return data.marketValue || Infinity;\n  }\n}\n\nfunction craftingPrice(results, item, overrides) {\n  return Object.entries(results[item].crafting).reduce((total, [name, quantity]) => total + itemPrice(results, name, overrides) * quantity, results[item].requiredMoney);\n}\n\nfunction profLabel(data) {\n  if (profNames[data.category]) {\n    if (data.amountCrafted !== 1) {\n      return <span><span className={\"trade-icon trade-\" + data.category}/>{profNames[data.category]} (per {data.amountCrafted}): </span>;\n    } else {\n      return <span><span className={\"trade-icon trade-\" + data.category}/>{profNames[data.category]}: </span>;\n    }\n  } else {\n    return \"\";\n  }\n}\n\nfunction shoppingList(list, results, item, count, overrides) {\n  const mode = overrides[item] || itemDefault(results, item);\n  const data = results[item];\n  if (data.vendorPrice || !data.crafting || mode !== \"crafting\") {\n    list[item] = (list[item] || 0) + count;\n  } else {\n    const numCraft = Math.ceil(count / data.craftMin);\n    Object.entries(data.crafting).forEach(([name, quantity]) => shoppingList(list, results, name, quantity * numCraft, overrides));\n    if (data.requiredMoney) {\n      list.money = (list.money || 0) + data.requiredMoney;\n    }\n  }\n  return list;\n}\n\nfunction ItemLink({name, data}) {\n  if (data.id) {\n    return <a className={\"quality-\" + data.quality} href={`https://classic.wowhead.com/item=${data.id}`} target=\"_blank\" rel=\"noreferrer\">{name}</a>;\n  } else {\n    return <span className={\"quality-\" + data.quality}>{name}</span>;\n  }\n}\n\nfunction ResultView({results, item, count, overrides, setOverrides}) {\n  const setMarket = React.useCallback(() => setOverrides(ov => ({...ov, [item]: \"market\"})), [setOverrides, item]);\n  const setCrafting = React.useCallback(() => setOverrides(ov => ({...ov, [item]: \"crafting\"})), [setOverrides, item]);\n\n  const data = results[item];\n  if (!data) return null;\n\n  let price = null;\n  const mode = overrides[item] || itemDefault(results, item);\n\n  if (data.vendorPrice) {\n    price = <React.Fragment>Vendor: <Money value={data.vendorPrice}/></React.Fragment>;\n  } else if (!data.marketValue && !data.crafting) {\n    price = data.bindOnPickup ? \"Bind on Pickup\" : \"Not available\";\n  } else if (data.marketValue || data.craftingPrice) {\n    price = (\n      <React.Fragment>\n        {!!data.marketValue && <span onClick={setMarket} className={mode === \"market\" ? \"active\" : \"inactive\"}>Market{data.faction ? ` (${data.faction})` : \"\"}: <Money value={data.marketValue}/> (quantity: {data.quantity})</span>}\n        {!!(data.marketValue && data.crafting) && \" / \"}\n        {!!data.crafting && <span onClick={setCrafting} className={mode === \"crafting\" ? \"active\" : \"inactive\"}>{profLabel(data)}<Money value={craftingPrice(results, item, overrides)}/></span>}\n      </React.Fragment>\n    );\n  }\n  return (\n    <div className=\"item\">\n      <div className=\"header\">{!!count && <span className=\"count\">{count}x</span>}<ItemLink name={item} data={data}/>{!!price && \" - \"}{price}</div>\n      {!!(!data.vendorPrice && mode === \"crafting\" && data.crafting) && (\n        <div className=\"crafting\">\n          {Object.entries(data.crafting).map(([name, quantity]) => <ResultView key={name} results={results} item={name} count={quantity} overrides={overrides} setOverrides={setOverrides}/>)}\n          {!!data.requiredMoney && (\n            <div className=\"item\">\n              <div className=\"header\">Required Money: <Money value={data.requiredMoney}/></div>\n            </div>\n          )}\n        </div>\n      )}\n    </div>\n  );\n}\n\nfunction ShoppingList({results, item, overrides}) {\n  const list = React.useMemo(() => {\n    const res = Object.entries(shoppingList({}, results, item, 1, overrides)).filter(([name, count]) => count > 0);\n    const price = data => data ? (data.vendorPrice || data.marketValue || Infinity) : 0;\n    res.sort(([n1, c1], [n2, c2]) => price(results[n2]) * c2 - price(results[n1]) * c1);\n    return res;\n  }, [results, item, overrides]);\n  if (!list.length) {\n    return null;\n  }\n  return (\n    <div className=\"shopping-list\">\n      <div className=\"header\">Shopping List</div>\n      <ul>\n        {list.map(([name, count]) => {\n          if (name === \"money\") {\n            return <li>Money: <Money value={count}/></li>\n          }\n          const data = results[name];\n          let price = null;\n          if (data.vendorPrice) {\n            price = <span>Vendor: <Money value={data.vendorPrice * count}/></span>;\n          } else if (!data.marketValue) {\n            price = data.bindOnPickup ? \"Bind on Pickup\" : \"Not available\";\n          } else {\n            price = <span>Market{data.faction ? ` (${data.faction})` : \"\"}: <Money value={data.marketValue * count}/></span>;\n          }\n          return <li><span className=\"count\">{count}x</span><ItemLink name={name} data={results[name]}/> - {price}</li>;\n        })}\n      </ul>\n    </div>\n  );\n}\n\nexport default function App() {\n  const [serverList, setServerList] = React.useState([]);\n  React.useEffect(() => {\n    serverOptions.then(opt => setServerList(opt));\n  }, []);\n\n  const [server, setServer] = usePersistentState(\"wowcrafting-server\");\n  const [faction, setFaction] = usePersistentState(\"wowcrafting-faction\", factionOptions[0]);\n  const [item, setItem] = React.useState();\n  const [results, setResults] = React.useState();\n  const [overrides, setOverrides] = React.useState({});\n\n  const onServerChange = React.useCallback(v => {\n    setResults(null);\n    setOverrides({});\n    setServer(v);\n  }, [setServer]);\n  const onFactionChange = React.useCallback(v => {\n    setResults(null);\n    setOverrides({});\n    setFaction(v);\n  }, [setFaction]);\n  const onItemChange = React.useCallback(v => {\n    setResults(null);\n    setItem(v);\n  }, []);\n\n  const toCalc = React.useRef();\n  React.useEffect(() => {\n    if (!server || !faction || !item) return;\n    const slug = `${server.value}-${faction.value}-${item.value}`;\n    toCalc.current = slug;\n    setResults(true);\n    calculate(server.value, faction.value, item.value).then(data => {\n      if (toCalc.current === slug) {\n        setResults(data);\n      }\n    });\n  }, [server, faction, item]);\n\n  return (\n    <div className=\"App\">\n      <div className=\"config\">\n        <Select className=\"select-server\" value={server} onChange={onServerChange} options={serverList} placeholder=\"Select server...\"/>\n        <Select className=\"select-faction\" value={faction} onChange={onFactionChange} options={factionOptions}/>\n        {!!(server && faction) && <AsyncSelect className=\"select-item\" value={item} onChange={onItemChange} loadOptions={itemOptions} noOptionsMessage={() => null} placeholder=\"Select item...\"/>}\n      </div>\n      {!!(results && item) && (\n        <div className=\"Results\">\n          {results === true ? (\n            <div className=\"calculating\">Calculating...</div>\n          ) : (\n            <div className=\"results-main\">\n              <ResultView results={results} item={item.value} overrides={overrides} setOverrides={setOverrides}/>\n            </div>\n          )}\n          {results !== true && <ShoppingList results={results} item={item.value} overrides={overrides}/>}\n        </div>\n      )}\n    </div>\n  );\n}\n","import React from 'react';\nimport ReactDOM from 'react-dom';\nimport './reset.css';\nimport App from './App';\n\nReactDOM.render(\n  <App />,\n  document.getElementById('root')\n);\n"],"sourceRoot":""}